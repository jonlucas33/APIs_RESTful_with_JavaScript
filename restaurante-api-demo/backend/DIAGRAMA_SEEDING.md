# ğŸ“Š DIAGRAMA VISUAL - Arquitetura de Seeding

## ğŸ—ï¸ Estrutura de 3 Camadas

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CAMADA 1: DADOS (Mocks)                     â”‚
â”‚                     Responsabilidade: Armazenar                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   ğŸ“¦ cardapio.mock.js          ğŸ“¦ comandas.mock.js             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚ const data = [  â”‚          â”‚ const data = [  â”‚            â”‚
â”‚   â”‚   { nome: 'â€¦' } â”‚          â”‚   { mesa: 5 }   â”‚            â”‚
â”‚   â”‚ ]               â”‚          â”‚ ]               â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚          â”‚                              â”‚                       â”‚
â”‚          â”‚ export                       â”‚ export                â”‚
â”‚          â–¼                              â–¼                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                              â”‚
          â”‚ import                       â”‚ import
          â–¼                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   CAMADA 2: LÃ“GICA (Seeders)                    â”‚
â”‚                   Responsabilidade: Inserir                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   ğŸŒ± cardapio.seeder.js      ğŸŒ± comandas.seeder.js             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚ function seed(  â”‚        â”‚ function seed(  â”‚              â”‚
â”‚   â”‚   client        â”‚        â”‚   client        â”‚              â”‚
â”‚   â”‚ ) {             â”‚        â”‚ ) {             â”‚              â”‚
â”‚   â”‚   TRUNCATE...   â”‚        â”‚   TRUNCATE...   â”‚              â”‚
â”‚   â”‚   INSERT $1...  â”‚        â”‚   INSERT $1...  â”‚              â”‚
â”‚   â”‚ }               â”‚        â”‚ }               â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚          â”‚                            â”‚                         â”‚
â”‚          â”‚ export                     â”‚ export                  â”‚
â”‚          â–¼                            â–¼                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                            â”‚
          â”‚ import                     â”‚ import
          â–¼                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 CAMADA 3: ORQUESTRAÃ‡ÃƒO (Maestro)                â”‚
â”‚                 Responsabilidade: Coordenar                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   ğŸ­ seed.js (Runner)                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚ async function runSeeders() {                 â”‚            â”‚
â”‚   â”‚   const client = await pool.connect();        â”‚            â”‚
â”‚   â”‚                                                â”‚            â”‚
â”‚   â”‚   await client.query('BEGIN'); â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚            â”‚
â”‚   â”‚                                           â”‚    â”‚            â”‚
â”‚   â”‚   await seedCardapio(client);             â”‚    â”‚            â”‚
â”‚   â”‚   await seedComandas(client);             â”‚    â”‚            â”‚
â”‚   â”‚                                           â”‚    â”‚            â”‚
â”‚   â”‚   await client.query('COMMIT'); â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚            â”‚
â”‚   â”‚                                           â”‚    â”‚            â”‚
â”‚   â”‚   // Em caso de erro:                    â”‚    â”‚            â”‚
â”‚   â”‚   // await client.query('ROLLBACK'); â”€â”€â”€â”€â”¤    â”‚            â”‚
â”‚   â”‚ }                                         â”‚    â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚            â”‚
â”‚                           â”‚                        â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚                        â”‚
                            â–¼                        â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
                    â”‚  PostgreSQL  â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚   Database   â”‚  TRANSAÃ‡ÃƒO
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Fluxo de ExecuÃ§Ã£o com TransaÃ§Ã£o

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  $ npm run seed                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ 1. Validar .env           â”‚
            â”‚    âœ… Credenciais OK      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ 2. Conectar ao Pool       â”‚
            â”‚    client = pool.connect()â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  3. BEGIN TRANSACTION                             â•‘
    â•‘  (Inicia modo "tudo ou nada")                     â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                            â”‚
                            â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ 4a. seedCardapio(client)  â”‚
            â”‚     TRUNCATE cardapio     â”‚
            â”‚     INSERT 6 itens        â”‚
            â”‚     âœ… Sucesso            â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ 4b. seedComandas(client)  â”‚
            â”‚     TRUNCATE comandas     â”‚
            â”‚     INSERT 3 comandas     â”‚
            â”‚     âœ… Sucesso            â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚                 â”‚
           SUCESSO â–¼                 â–¼ ERRO
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  5a. COMMIT       â•‘    â•‘  5b. ROLLBACK     â•‘
    â•‘  Grava no disco   â•‘    â•‘  Reverte tudo     â•‘
    â•‘  Dados permanentesâ•‘    â•‘  Volta ao inÃ­cio  â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            â”‚                         â”‚
            â–¼                         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ğŸ‰ Sucesso!  â”‚          â”‚ âŒ Erro!     â”‚
    â”‚ exit(0)      â”‚          â”‚ exit(1)      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Separation of Concerns (SeparaÃ§Ã£o de Responsabilidades)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PERGUNTA                â”‚  QUEM RESPONDE?                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Quais dados inserir?     â”‚  ğŸ“¦ MOCKS (cardapio.mock.js)        â”‚
â”‚ Como inserir?            â”‚  ğŸŒ± SEEDERS (cardapio.seeder.js)    â”‚
â”‚ Em que ordem?            â”‚  ğŸ­ MAESTRO (seed.js)               â”‚
â”‚ Gerenciar transaÃ§Ãµes?    â”‚  ğŸ­ MAESTRO (seed.js)               â”‚
â”‚ Conectar ao banco?       â”‚  ğŸ­ MAESTRO (seed.js)               â”‚
â”‚ Tratar erros globais?    â”‚  ğŸ­ MAESTRO (seed.js)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Vantagens:**
- âœ… Cada arquivo tem UMA responsabilidade
- âœ… FÃ¡cil de testar isoladamente
- âœ… FÃ¡cil de modificar sem afetar outros
- âœ… ReutilizÃ¡vel em diferentes contextos

---

## ğŸ”’ ACID na PrÃ¡tica

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SEM TRANSAÃ‡ÃƒO (âŒ ProblemÃ¡tico)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   INSERT cardapio...  â”€â”€â–º âœ… SALVO no banco                     â”‚
â”‚   INSERT comandas...  â”€â”€â–º âŒ ERRO!                              â”‚
â”‚                                                                 â”‚
â”‚   Resultado: CardÃ¡pio inserido, comandas NÃƒO                   â”‚
â”‚   Estado: INCONSISTENTE! âš ï¸                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  COM TRANSAÃ‡ÃƒO (âœ… Correto)                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚   BEGIN;                                                        â”‚
â”‚   INSERT cardapio...  â”€â”€â–º â³ TEMPORÃRIO                         â”‚
â”‚   INSERT comandas...  â”€â”€â–º âŒ ERRO!                              â”‚
â”‚   ROLLBACK;           â”€â”€â–º ğŸ”™ TUDO REVERTIDO                     â”‚
â”‚                                                                 â”‚
â”‚   Resultado: NADA foi inserido                                 â”‚
â”‚   Estado: CONSISTENTE! âœ…                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ†š ComparaÃ§Ã£o: Arquitetura MonolÃ­tica vs Profissional

### âŒ Arquitetura MonolÃ­tica (1 arquivo)

```
seed.js (200 linhas)
â”œâ”€â”€ Dados hardcoded
â”œâ”€â”€ LÃ³gica SQL
â”œâ”€â”€ Gerenciamento de conexÃ£o
â”œâ”€â”€ Tratamento de erros
â””â”€â”€ ExecuÃ§Ã£o

Problemas:
- DifÃ­cil de testar
- DifÃ­cil de reutilizar dados
- Sem transaÃ§Ãµes
- DifÃ­cil de manter
```

### âœ… Arquitetura Profissional (3 camadas)

```
ğŸ“¦ mocks/
â”‚   â”œâ”€â”€ cardapio.mock.js (20 linhas)
â”‚   â””â”€â”€ comandas.mock.js (30 linhas)
â”‚
ğŸŒ± seeds/
â”‚   â”œâ”€â”€ cardapio.seeder.js (40 linhas)
â”‚   â””â”€â”€ comandas.seeder.js (40 linhas)
â”‚
ğŸ­ seed.js (150 linhas)
    â””â”€â”€ OrquestraÃ§Ã£o + TransaÃ§Ãµes

Vantagens:
+ FÃ¡cil de testar cada camada
+ Dados reutilizÃ¡veis
+ TransaÃ§Ãµes ACID
+ FÃ¡cil de adicionar novos seeders
+ FÃ¡cil de manter
```

---

## ğŸ“‹ Checklist de ImplementaÃ§Ã£o

### Para o Professor

- [ ] Explicar conceito de Separation of Concerns
- [ ] Demonstrar execuÃ§Ã£o do seed
- [ ] Simular erro e mostrar ROLLBACK
- [ ] Mostrar logs detalhados
- [ ] Explicar ACID com exemplos prÃ¡ticos
- [ ] Comparar com arquitetura antiga

### Para o Aluno

- [ ] Entendo por que separar dados (mocks) de lÃ³gica (seeders)
- [ ] Sei o que Ã© uma transaÃ§Ã£o SQL
- [ ] Entendo BEGIN/COMMIT/ROLLBACK
- [ ] Sei por que usar prepared statements ($1, $2)
- [ ] Consigo adicionar um novo seeder
- [ ] Sei explicar o papel do Maestro

---

## ğŸ“ Conceitos-Chave para a Aula

### 1. Separation of Concerns

**Conceito:** Cada mÃ³dulo tem UMA responsabilidade clara.

**Analogia:** Restaurante
- ğŸ“¦ Fornecedor (Mock): Entrega ingredientes
- ğŸŒ± Cozinheiro (Seeder): Prepara os pratos
- ğŸ­ Gerente (Maestro): Coordena tudo

---

### 2. ACID (TransaÃ§Ãµes)

**Conceito:** Garantias de integridade do banco de dados.

**Analogia:** TransferÃªncia bancÃ¡ria
- Debita R$100 da Conta A
- Credita R$100 na Conta B
- Se QUALQUER operaÃ§Ã£o falhar â†’ ROLLBACK em tudo
- Nunca fica inconsistente

---

### 3. Dependency Order (Ordem de DependÃªncias)

**Conceito:** Respeitar ordem de execuÃ§Ã£o baseada em relacionamentos.

**Analogia:** ConstruÃ§Ã£o
- Primeiro: Alicerce (cardÃ¡pio)
- Depois: Paredes (comandas que referenciam cardÃ¡pio)
- Nunca: Paredes sem alicerce!

---

### 4. Transaction-Aware Functions

**Conceito:** FunÃ§Ãµes que recebem `client` ao invÃ©s de usar `pool`.

**Por quÃª?**
```javascript
// âŒ ERRADO: Cada INSERT em transaÃ§Ã£o separada
async function seed() {
  await pool.query('INSERT...');  // TransaÃ§Ã£o 1
  await pool.query('INSERT...');  // TransaÃ§Ã£o 2
  // Se 2 falhar, 1 jÃ¡ foi commitado!
}

// âœ… CORRETO: Tudo na mesma transaÃ§Ã£o
async function seed(client) {
  await client.query('INSERT...');  // Mesma transaÃ§Ã£o
  await client.query('INSERT...');  // Mesma transaÃ§Ã£o
  // Se qualquer um falhar, tudo reverte!
}
```

---

## ğŸš€ ExecuÃ§Ã£o de Exemplo

```bash
$ npm run seed

ğŸŒ± INICIANDO PROCESSO DE SEEDING
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”„ Iniciando transaÃ§Ã£o SQL (BEGIN)...

   ğŸ“‹ Populando tabela: cardapio...
      ğŸ§¹ Tabela limpa
      âœ… 6 itens inseridos no cardÃ¡pio

   ğŸ“ Populando tabela: comandas...
      ğŸ§¹ Tabela limpa
      âœ… 3 comandas inseridas

âœ… Todos os seeders executados com sucesso!
ğŸ’¾ Fazendo COMMIT da transaÃ§Ã£o...

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ‰ SEEDING CONCLUÃDO COM SUCESSO!
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ‘‹ ConexÃ£o com o banco encerrada.
```

---

**Material DidÃ¡tico - ImplantaÃ§Ã£o de Sistemas**  
**Diagramas Visuais de Arquitetura de Seeding**  
**VersÃ£o:** 2.0 | Fevereiro 2026
